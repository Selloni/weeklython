# 3.1. Проектирование CI

# Этап 1 — сборка
# Собираем код, выходные файлы публикуем как артефакты
# Этап 2 — тестирование
# Получаем артефакты с этапа сборки, гоняем тесты, собраем данные покрытия кода
# Этап 3 — отправка
# Задача 1 — собираем nuget-пакет и отправляем в Azure DevOps
# Задача 2 — собираем сайт из xmldoc в исходном коде и публикуем в GitLab Pages

## в каком окружении все будет запускаться
image: node:latest

## pages – название процесса, потом увидим его в интерфейса
pages:
  ## stage – этап билда, по дефолтку их три: build, test, deploy.
  ## Этапы всегда идут в четком порядке. Можно не указывать ничего, тогда запустится на этапе test. 
  ## Для нас в данной ситуации это не критично, но понимание пригодится попозже
  stage: deploy
  ## перекладываем уже собранное и запушенное из папки dist в папку public
  ## название важно – gitlab умеет деплоить как статику только то, что находится в папке public
  script:
    - mv dist public
  ## Говорим, что да, хотим задеплоить папку public!
  artifacts:
    paths:
    - public
  ## разрешаем совершать весь этот шаг pages только для ветки master
  only:
  - master]